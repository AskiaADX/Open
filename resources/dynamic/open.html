{%
Dim inputName  =  CurrentQuestion.InputName()
Dim inputValue =  CurrentQuestion.InputValue()

Dim datalist    = CurrentADC.PropValue("datalist").Split("|")
Dim attrList    = On(datalist.Count > 0, "list=\"" + inputName + "\"", "")
Dim i

Dim inputType  = CurrentADC.PropValue("opensubtype")
Dim multiline  = (CurrentADC.PropValue("multiline") = "1") ' Convert to boolean

Dim floatinglabel = (CurrentADC.PropValue("floatingLabel")="1")


Dim placeholder = On(floatinglabel and CurrentADC.PropValue("placeholder")="", currentQuestion.LongCaption, CurrentADC.PropValue("placeholder"))

Dim attrPlaceholder = On(placeholder <> "" and Not(floatinglabel) , "placeholder=\"" + placeholder + "\"", "")
Dim useBrowserValidation = "" + CurrentADC.PropValue("useBrowserValidation")

Dim attrRequired = ""
Dim maxchar = CurrentADC.PropValue("maxChar").ToNumber()
Dim attrMaxLength = ""
Dim minchar = CurrentADC.PropValue("minChar").ToNumber()
Dim attrMinLength = ""

if useBrowserValidation = "1" then
	attrRequired = On(CurrentQuestion.IsAllowDK, "", "required=\"required\"")
    attrMaxLength = "maxlength=\"" + maxchar + "\""
   attrMinLength = "minlength=\"" + minchar + "\""
else
    if maxchar > 0 then
        attrMaxLength = "onkeypress=\"return imposeMaxLength(event, this, "+maxchar+");\" onkeydown=\"return imposeMaxLengthOnKeydown(event, this, "+maxchar+");\" onpaste=\"return imposeMaxLengthOnPaste(event, this, "+maxchar+");\""
    EndIf
EndIf

Dim suggestedchartext = CurrentADC.PropValue("suggestedCharText")
Dim prefixtext = CurrentADC.PropValue("prefixText")
Dim suggestedchar = CurrentADC.PropValue("suggestedChar").ToNumber()

Dim countorder = CurrentADC.PropValue("counter")

dim arearows = CurrentADC.PropValue("areaRows")
dim areacolumns = CurrentADC.PropValue("areaColumns")
'cols="areacolumns"
dim attrControlAlign = CurrentADC.PropValue("controlAlign")

dim attrInputType = CurrentADC.PropValue("inputType")

Dim adcSelector = "adc_" + CurrentADC.InstanceId
dim showCongrats = CurrentADC.PropValue("showCongrats")
dim congratsMessage = CurrentADC.PropValue("congratsMessage")

'On(countOrder="desc",maxchar,"0")

Dim exclusiveQuestion = CurrentADC.PropQuestion("exclusiveResponsesQuestion")

Dim showCharCounterMeter = CurrentADC.PropValue("showCharCounterMeter")

%}
<div id="{%= adcSelector %}" class="adc-open">
    <div class="adc-open-content {%=attrControlAlign%}">

			{%
				IF showCharCounterMeter = "1" THEN
					Dim charMeterPosition = CurrentADC.PropValue("charMeterPosition")
			%}

			{% IF charMeterPosition = "top" THEN %}
				<div class="meterDiv top">
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
					<span class="outer"><span class="inner"></span></span>
				</div>
			{% ENDIF %}

			{% IF charMeterPosition = "left" OR charMeterPosition = "right" THEN %}
			<table>
				<tr>
					<td>
						{% IF charMeterPosition = "left" Then %}
						<div class="meterDiv left">
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
							<span class="outer"><span class="inner-st"></span></span>
						</div>
						{% ENDIF %}
					</td>
					<td style="width:100%">
			{% ENDIF %}

				<div class="counterdiv">
            <div class="counter-helper">
            {%If prefixtext <>"" then%}
            <span class="prefixtext">{%=prefixtext%}</span>
            {%endif%}
            <span class="counter">
                <b>
                {%If countorder="none" then%}
                {%Else
									If countorder = "desc" Then %}
        				{%=maxchar%}
    						{%else%}
        				0
								{%EndIf%}
								{%endif%}
                </b>
            </span>
            <span><b>{%=On(countorder <> "asc","","/"+maxchar)%}</b></span>
             	{%If suggestedchar>0 Then%}
                <span class="suggestedchar">
                	{%=suggestedchartext%} <b>{%=suggestedchar%}</b>
            	</span>
                {%Endif%}
          </div>
            <div class="congrats-message" style="display:none">{%=congratsMessage%}</div>
        </div>
        <label for="{%= inputName %}" hidden>Open</label>
        {% If attrInputType = "textarea" then %}
        	<textarea class="contentinput open" rows="{%=arearows%}" name="{%= inputName %}" id="{%= inputName %}" {%:= attrPlaceholder %}
					{%:= attrMaxLength %} {%:= attrMinLength %} {%:= attrRequired %}>{%= inputValue %}</textarea>
        {% Else %}
        	{% If floatinglabel then %}<label>{% Endif %}
        	<input type="{%= attrInputType %}" id="{%= inputName %}" class="open" name="{%= inputName %}" {%:= attrMaxLength %} {%:= attrPlaceholder %}
					{%:= attrMinLength %} {%:= attrRequired %} value="{%= inputValue %}"/>
          {% If floatinglabel then %}
        	<span class="floating-label">{%:= Placeholder %}</span>
        	{%Endif%}
	        {% If floatinglabel then %}</label>{% Endif %}
        {% Endif %}

				{% IF charMeterPosition = "left" OR charMeterPosition = "right" THEN %}
				</td>
				<td>
					{% IF charMeterPosition = "right" Then %}
					<div class="meterDiv right">
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
						<span class="outer"><span class="inner-st"></span></span>
					</div>
					{% ENDIF %}
				</td>
				</tr>
				</table>
				{% ENDIF %}

				{% IF charMeterPosition = "bottom" THEN %}
					<div class="meterDiv bottom">
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
						<span class="outer"><span class="inner"></span></span>
					</div>
				{% ENDIF %}

			{% ELSE %}

        <div class="counterdiv">
            <div class="counter-helper">
            {%If prefixtext <>"" then%}
            <span class="prefixtext">{%=prefixtext%}</span>
            {%endif%}
            <span class="counter">
                <b>
                {%If countorder="none" then%}
                {%Else
									If countorder = "desc" Then %}
        				{%=maxchar%}
    						{%else%}
        				0
								{%EndIf%}
								{%endif%}
                </b>
            </span>
            <span><b>{%=On(countorder <> "asc","","/"+maxchar)%}</b></span>
             	{%If suggestedchar>0 Then%}
                <span class="suggestedchar">
                	{%=suggestedchartext%} <b>{%=suggestedchar%}</b>
            	</span>
                {%Endif%}
          </div>
            <div class="congrats-message" style="display:none">{%=congratsMessage%}</div>
        </div>
        <label for="{%= inputName %}" hidden>Open</label>
        {% If attrInputType = "textarea" then %}
        	<textarea class="contentinput" rows="{%=arearows%}" name="{%= inputName %}" id="{%= inputName %}" {%:= attrPlaceholder %}
					{%:= attrMaxLength %} {%:= attrMinLength %} {%:= attrRequired %}>{%= inputValue %}</textarea>
        {% Else %}
        	{% If floatinglabel then %}<label>{% Endif %}
        	<input type="{%= attrInputType %}" id="{%= inputName %}" name="{%= inputName %}" {%:= attrMaxLength %} {%:= attrPlaceholder %}
					{%:= attrMinLength %} {%:= attrRequired %} value="{%= inputValue %}"/>
          {% If floatinglabel then %}
        	<span class="floating-label">{%:= Placeholder %}</span>
        	{%Endif%}
	        {% If floatinglabel then %}</label>{% Endif %}
        {% Endif %}

				{% ENDIF %}

				{% If (exclusiveQuestion.Type = "single") Then %}
					<ul>
							{%
							Dim inputId
							Dim attrChecked
							Dim caption
							Dim resource
							Dim ar = exclusiveQuestion.AvailableResponses
							For i = 1 To ar.Count
									'inputName		= exclusiveQuestion.InputName()
									inputId     = inputName + "_" + i
									attrChecked = On(ar[i].IsSelected, "checked=\"checked\"", "")
									inputValue  = ar[i].InputValue()
									caption     = ar[i].Caption
									resource		= ar.ResourceURL[i]
							%}
							<li class="askia-response DK openDK">
									<input type="hidden" name="B{%= i %}">
									<input type="checkbox" name="{%= exclusiveQuestion.InputName() %}" id="{%= inputId %}" value="{%= inputValue %}" {%:= attrChecked %} class="dkbutton askia-live" onclick="exclusiveResponse(this);"/>
									<label for="{%= inputId %}" class="askia-checkbox"><span hidden>Radio</span></label>
									<label for="{%= inputId %}" class="askia-response-label">
											{% IF (resource <> "") Then %}
												<img src="{%= resource %}" style="vertical-align:middle" alt="{%:= caption %}"/>
											{% EndIf %}{%:= caption %}
									</label>
							</li>
							{% Next i %}
						</ul>
				{% Endif %}

        {% If datalist.Count > 0 Then %}
            <datalist id="{%= inputName %}">
            {% For i = 1 To datalist.count %}
                <option value="{%= datalist[i] %}" />
            {% Next %}
            </datalist>
        {% EndIf %}
    </div>
</div>
